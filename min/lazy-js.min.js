console.log("Executing scroll.js");app.directive("scroll",["$window","initialJSON",function($window,initialJSON){console.log("Executing scroll directive");return function(scope){var scrollHandler=function(){initialJSON.jquery.then(function(){if($("#games").length&&this.pageYOffset>=$("#games").outerHeight()-2e3){if(scope.cat!==undefined){scope.cat.requestGames(18)}else{scope.master.requestGames(18)}}})};angular.element($window).on("scroll",scrollHandler);scope.$on("$destroy",function(){angular.element($window).off("scroll",scrollHandler)})}}]);app.controller("lazyStuff",["$http","$scope","local","$location","$routeParams","$lhttp","urls",function($http,$scope,local,$location,$routeParams,$lhttp,urls){var vm=this;$scope.master.rate=function(x,action,i){if(!$scope.master.disabled){$scope.master.disabled=true;var start=Date.now();var request=$http({method:"get",url:urls.rating+"?action="+action+"&id="+x});request.success(function(data){var stop=Date.now();var diff=(stop-start)/1e3;console.log(data.logdata);document.getElementById(x).innerHTML=data.data;$scope.master.disabled=false});request.error(function(status){document.getElementById(x).innerHTML="ERROR "+status;$scope.master.disabled=false})}};$scope.master.disabled=false;var mas=$scope.master;mas.toggleTags=function(){mas.showAllTags=!mas.showAllTags};mas.search=function(){$location.path("tag/"+mas.otag);mas.collapseTags()};mas.goTo=function(url){$location.path(url);mas.collapseTags()};mas.goToGame=function(id){$location.path("id/"+id)};mas.goHome=function(){$location.path("");mas.collapseTags()};mas.collapseTags=function(){mas.showAllTags=false};mas.ifHome=function(){return $location.path()=="/"};mas.ifAtSubmit=function(){return $location.path()=="/submit"};mas.ifAt=function(x){return $location.path()==x};mas.tagIs=function(x){if(typeof $routeParams.category!="undefined"){return $routeParams.category.toLowerCase()==x.toLowerCase()}return false};for(var attrname in mas){try{$scope.master[attrname]=mas[attrname]}catch(e){console.warn(e)}}getCss("ubuntu","ubuntu.css");getCss("glyphs","custom_bootstrap/glyphicons.min.css");getCss("listGroups","custom_bootstrap/list-groups.min.css");function getCss(x,url){$lhttp.get("/src/css/"+url,0).then(function(data){$scope.master.css+=data})}$scope.master.mlcLoaded=true}]);app.controller("cookieCtrl",["$timeout",function($timeout){var vm=this;vm.template="";vm.close=function(){$(".cookie-box").css("opacity",0);$timeout(function(){$(".cookie-box").remove()},500);if(typeof Storage!=="undefined"){localStorage.cookieAccept="true"}else{document.cookie="cookiescriptaccept=visit"}};if(typeof Storage!=="undefined"&&localStorage.cookieAccept!="true"&&getCookieValue("cookiescriptaccept")!="visit"){$timeout(function(){try{document.getElementsByClassName("cookie-box")[0].setAttribute("style","opacity:1;")}catch(e){console.warn(e)}$timeout(vm.close,5e3)},2500)}else{document.querySelector("#cookies").remove()}function getCookieValue(a,b){b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b?b.pop():""}}]);app.controller("submitCtrl",["$http","$scope","initialJSON","urls",function($http,$scope,initialJSON,urls){var vm=this;vm.tagValReg=/.*#.+/i;vm.game={title:"",comments:[],likes:2,height:"n",width:"100%",public:true,instructions:"",tags:[],thumbnail:"",file:"",description:"",mobile:false};vm.gameTags="";vm.gameHeight="";vm.gameWidth="";vm.showPreview=false;vm.loading=false;vm.success=false;vm.errors={EMBED_ERROR:false,IMAGE_ERROR:false,DESC_ERROR:false,MISSING_KEYS:[],OTHER_ERROR:false};vm.showP=function(){vm.showPreview=true};var isNum=val=>/^[\d\.,]+$/.test(val)||val=="n"||val=="r"||/[0-9\.,]*px$/.test(val)||/[0-9\.,]*%$/.test(val);vm.submit=function(){if(isNum(vm.gameHeight)&&isNum(vm.gameWidth)){vm.game.height=vm.gameHeight;vm.game.width=vm.gameWidth}vm.game.tags=extractTags(vm.gameTags);if(vm.submitGame.$valid){vm.loading=true;var request=$http({method:"get",url:urls.submitGame+"?"+createQueryString(vm.game)});request.success(function(data){vm.showPreview=false;vm.loading=false;vm.errors=data.errors;vm.success=data.success;if(data.success){vm.game={title:"",comments:[],likes:2,height:"n",width:"100%",public:true,instructions:"",tags:[],thumbnail:"",file:"",description:""};vm.showPreview=false}});request.error(function(data,status){vm.errors.OTHER_ERROR=true;vm.loading=false;console.log("Data:",data,"status:",status)})}};function toTitleCase(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}function extractTags(str){if(str.length>0){var tags=str.match(/#[^#]+/g);for(i=0;i<tags.length;i++){try{tags[i]=tags[i].replace("#","");tags[i]=tags[i].trim();tags[i]=toTitleCase(tags[i])}catch(e){console.warn(e)}}return tags}return[]}function createQueryString(obj){var str=[];for(let p in obj)obj.hasOwnProperty(p)?str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p])):null;return str.join("&")}vm.init=function(){console.log("initialized");initialJSON.jquery.then(function(){$("textarea").each(function(index){$(this).attr("rows",Math.ceil($(this).attr("placeholder").length*(430/56)/$(this).width()))})})}}]);app.controller("homeCtrl",["$http","$rootScope","$scope","$timeout","initialJSON",function($http,$rootScope,$scope,$timeout,initialJSON){var vm=this;vm.len="...";$rootScope.$on("$locationChangeStart",function(event){$scope.master.routeChanged=true});$scope.master.loc="Thorin-Games — The best place on the internet to play Flash and HTML5 games";$scope.master.desc="Welcome to Thorin-Games. Here you can find a broad selection of flash and html5 games sorted by popularity and category.";if($scope.master.norsk){$scope.master.loc="Thorin-Games — Den beste siden på internett for å spille Flash og HTML5 spill";$scope.master.desc="Velkommen til Thorin-Games sin nettside. Her kan du finne nesten 2000 spill, sortert etter bl.a. kategori og hvor godt likt de er."}initialJSON.json.then(function(data){vm.len=data.count;try{if($scope.master.norsk){var tops="";for(var i=0;i<8;i++){tops+=data.topTags[i].name+" ("+data.topTags[i].amount+" spill), "}tops+=data.topTags[8].name+" ("+data.topTags[8].amount+" spill).";$scope.master.desc+=" De største kategoriene akkurat nå er "+tops}else{var tops="";for(var i=0;i<8;i++){tops+=data.topTags[i].name+" ("+data.topTags[i].amount+" games), "}tops+=data.topTags[8].name+" ("+data.topTags[8].amount+" games).";$scope.master.desc+=" Our top categories right now are "+tops}var tops="";for(var i=0;i<7;i++){tops+=" "+data.initialGames[i].title+" ("+data.initialGames[i].likes+" likes),"}tops+=" "+data.initialGames[7].title+" ("+data.initialGames[7].likes+" likes)";if($scope.master.norsk){$scope.master.desc+=" De mest populære spillene våre nå er"+tops}else{$scope.master.desc+=" Our most popular games right now are"+tops}}catch(e){console.warn(e)}})}]);app.service("local",[function(){var vm=this;vm.supported=typeof Storage!=="undefined";vm.set=function(key,value,expiration){if(typeof expiration!=="undefined"){localStorage[key]=JSON.stringify({str:value,expirationDate:expiration})}else{localStorage[key]=JSON.stringify({str:value})}};vm.get=function(key){if(vm.keyExist(key)){return JSON.parse(localStorage[key]).str}return};vm.setExpiration=function(key,ms){var obj=JSON.parse(localStorage[key]);obj.expirationDate=ms;localStorage[key]=JSON.stringify(obj)};vm.getExpiration=function(key){if(typeof JSON.parse(localStorage[key]).expirationDate!=="undefined"){return JSON.parse(localStorage[key]).expirationDate}else{return Infinity}};vm.keyExist=function(key){return typeof localStorage[key]!=="undefined"};for(var key in localStorage){if(vm.keyExist(key)&&typeof localStorage[key].expirationDate!=="undefined"&&localStorage[key].expirationDate<Date.now()){delete localStorage[key]}}}]);app.filter("mouthWash",function(){console.log("mouthWash.js loaded and executing");var badWords=["fuck","sex","porn","porno","faen","fakk","føkk","knull","pul","wank","runk","satan","bitch","fitte","fitta","jævl","jævel","mens","kill y","necro","rape","anus","arse","ass","axwound","blow job","blowjob","bollock","bollox","boner","butt","camel toe","chode","clit","cock","cooch","cum","cunt","dick","dildo"," fag","gay","homo","handjob","jerk"," jack","lesbi","phil","fil ","nigg","paki","penis","pecker","piss"," poon ","prick","pussy"," shit","slut ","suck","twat"," tit","tard ","tards ","vagin","whore","4r5e","5h1t","5hit","a55","anal","ar5e","arrse","ass-fucker","asses","assfucker","assfukka","asshole","assholes","asswhole","a_s_s","b!tch","b00bs","b17ch","b1tch","ballbag","balls","ballsack","bastard","beastial","beastiality","bellend","bestial","bestiality","bich","biatch","bitcher","bitchers","bitches","bitchin","bitching","bloody","blowjobs","boiolas","bollok","boob","boobs","booobs","boooobs","booooobs","booooooobs","breasts","buceta","bugger","bum","bunny fucker","butthole","buttmuch","buttplug","c0ck","c0cksucker","carpet muncher","cawk","chink","cipa","cl1t","clitoris","clits","cnut","cock-sucker","cockface","cockhead","cockmunch","cockmuncher","cocks","cocksuck ","cocksucked ","cocksucker","cocksucking","cocksucks ","cocksuka","cocksukka","cok","cokmuncher","coksucka","coon","cox","crap","cummer","cumming","cums","cumshot","cunilingus","cunillingus","cunnilingus","cuntlick ","cuntlicker ","cuntlicking ","cunts","cyalis","cyberfuc","cyberfuck ","cyberfucked ","cyberfucker","cyberfuckers","cyberfucking ","d1ck","damn","dickhead","dildos","dink","dinks","dirsa","dlck","dog-fucker","doggin","dogging","donkeyribber","doosh","duche","dyke","ejaculate","ejaculated","ejaculates ","ejaculating ","ejaculatings","ejaculation","ejakulate","f u c k","f4nny","fag","fagging","faggitt","faggot","faggs","fagot","fagots","fags","fanny","fannyflaps","fannyfucker","fanyy","fatass","fcuk","fcuker","fcuking","feck","fecker","felching","fellate","fellatio","fingerfuck ","fingerfucked ","fingerfucker ","fingerfuckers","fingerfucking ","fingerfucks ","fistfuck","fistfucked ","fistfucker ","fistfuckers ","fistfucking ","fistfuckings ","fistfucks ","flange","fook","fooker","fucka","fucked","fucker","fuckers","fuckhead","fuckheads","fuckin","fucking","fuckings","fuckingshitmotherfucker","fuckme ","fucks","fuckwhit","fuckwit","fudge packer","fudgepacker","fuk","fuker","fukker","fukkin","fuks","fukwhit","fukwit","fux","fux0r","f_u_c_k","gangbang","gaylord","gaysex","goatse","god-dam","god-damned","goddamn","goddamned","hardcoresex ","hell","heshe","hoar","hoare","hoer","hore","horniest","horny","hotsex","jack-off ","jackoff","jap","jerk-off ","jism","jiz ","jizm ","jizz","kawk","knob","knobead","knobed","knobend","knobhead","knobjocky","knobjokey","kock","kondum","kondums","kum","kummer","kumming","kums","kunilingus","l3ich","l3itch","labia","lust","lusting","m0f0","m0fo","m45terbate","ma5terb8","ma5terbate","masochist","master-bate","masterb8","masterbat","masterbat3","masterbate","masterbation","masterbations","masturbate","mo-fo","mof0","mofo","mothafuck","mothafucka","mothafuckas","mothafuckaz","mothafucked ","mothafucker","mothafuckers","mothafuckin","mothafucking ","mothafuckings","mothafucks","mother fucker","motherfuck","motherfucked","motherfucker","motherfuckers","motherfuckin","motherfucking","motherfuckings","motherfuckka","motherfucks","muff","mutha","muthafecker","muthafuckker","muther","mutherfucker","n1gga","n1gger","nazi","nigg3r","nigg4h","nigga","niggah","niggas","niggaz","nigger","niggers ","nob","nob jokey","nobhead","nobjocky","nobjokey","numbnuts","nutsack","orgasim ","orgasims ","orgasm","orgasms ","p0rn","pawn","penisfucker","phonesex","phuck","phuk","phuked","phuking","phukked","phukking","phuks","phuq","pigfucker","pimpis","pissed","pisser","pissers","pisses ","pissflaps","pissin ","pissing","pissoff ","poop","pornography","pornos","pricks ","pron","pube","pusse","pussi","pussies","pussys ","rectum","retard","rimjaw","rimming","s hit","s.o.b.","sadist","schlong","screwing","scroat","scrote","scrotum","semen","sh!","sh!t","sh1t","shag","shagger","shaggin","shagging","shemale","shi","shit","shitdick","shite","shited","shitey","shitfuck","shitfull","shithead","shiting","shitings","shits","shitted","shitter","shitters ","shitting","shittings","shitty ","skank","sluts","smegma","smut","snatch","son-of-a-bitch"," spac ","spunk","s_h_i_t","t1tt1e5","t1tties","teets","teez","testical","testicle"," tit","titfuck","tits","titt","tittie5","tittiefucker","titties","tittyfuck","tittywank","titwank","tosser","turd","tw4t","twathead","twatty","twunt","twunter","v14gra","v1gra","vagina","viagra","vulva","w00se","wang","wanker","wanky","whoar","willies","willy","xrated","xxx","fy fader"];return function(input,scope){if(!scope.master.verifiedUser&&typeof input!=="undefined"){angular.forEach(badWords,function(word){var regEx=new RegExp(word.split("").join("\\s*"),"gi");input=input.replace(regEx,"mooh")})}return input}});app.filter("chatTime",["$filter",function($filter){console.log("chatTime.js loaded and executing");var text={secs:"seconds ago",mins:"minutes ago",hours:"hours ago"};if(navigator.language.indexOf("nb")>-1||navigator.language.indexOf("nn")>-1||navigator.language.indexOf("no")>-1){text={secs:"sekunder siden",mins:"minutter siden",hours:"timer siden"}}return function(input){if(typeof input=="number"){var now=Date.now();var diff=now-input;if(diff<6e4){var secs=Math.floor(diff/1e3);return secs+" "+text.secs}else if(diff<36e5){var mins=Math.floor(diff/6e4);return mins+" "+text.mins}else if(diff<864e5){return $filter("date")(input,"HH:mm")}else if(diff<6e8){return $filter("date")(input,"EEE HH:mm")}else if(diff<31104e6){return $filter("date")(input,"dd/MM HH:mm")}else{return $filter("date")(input,"dd/MM/yyyy")}}else{return input}}}]);app.directive("embedSrc",function(){console.log("embedSrc.js loaded and executing");return{restrict:"A",link:function(scope,element,attrs){scope.$watch(function(){return attrs.embedSrc},function(){element.attr("src",attrs.embedSrc)})}}});app.controller("404Ctrl",["$location","$timeout","$scope",function($location,$timeout,$scope){var redirect=function(){$location.path("/")};$timeout(redirect,3e3);$scope.master.loc="Thorin-Games — "+$("h2")[0].innerText;$scope.master.desc=$(".error-content")[0].innerText.replace("\n",".")}]);